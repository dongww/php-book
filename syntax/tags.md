# 不得不提的语法

##标记

当 PHP 引擎解析文本的时候，它会试图寻找 PHP 特有的标记（完整的标记由开始标记和结束标记组成） `<?php` 和 `?>`，并把包含在标记中的内容识别为 PHP 代码。
如果解析器未找到结束标记，则会一直解析到文件结束。

PHP 的代码一般会出现在两种地方。一种是纯 PHP 文件，另一种是嵌入在其他格式的文件中，
最常见的是 html 文件，但仍以 .php 为后缀名。

> 一个纯 PHP 文件往往是集中进行逻辑处理和计算的地方，而当嵌入到比如 html 文件中的时候，
> 该文件往往是作为一个视图文件而存在的，那么在这个文件中就不应该放置太多进行数据处理和计算的代码，
> 而应当尽可能地仅用来调取经过处理后的数据并显示它。

请看下面的代码：

~~~ .php

<?php
//tags01.php

function today()
{
    $today = new DateTime();

    return $today->format('Y-m-d');
}

$todoList = [
    '09:00' => '调试代码',
    '14:00' => '完成 UML 制图',
    '17:00' => '下班去买菜',
];

require_once 'tags01_view.php';

~~~

~~~ .php

<!-- tags01_view.php -->
<!DOCTYPE html>
<html>
<head>
    <title>今天的 TODO 列表</title>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
</head>
<body>

<p>今天是：<?= today() ?>，今天该做的事情：</p>
<ul>
    <?php
    foreach ($todoList as $time => $event) {
        echo '<li>', $time, '：', $event, '</li>', PHP_EOL;
    }
    ?>
</ul>

</body>
</html>

~~~

上面列出了两个文件的代码，这两个文件是互相关联的。你可以试着运行一下 `basic01.php` 看看结果。

我们总共看到了三个部分的 PHP 代码。

首先是在 `tags01.php` 中，这是一个包含纯 PHP 代码的独立文件。
请注意，我们只使用了开始标记，而未使用结束标记。

> 如果文件内容是纯 PHP 代码，最好在文件末尾删除 PHP 结束标记。
> 这可以避免在 PHP 结束标记之后万一意外加入了空格或者换行符，会导致 PHP 开始输出这些空白，
> 而脚本中此时并无输出的意图。出处：
[http://php.net/manual/zh/language.basic-syntax.phptags.php](http://php.net/manual/zh/language.basic-syntax.phptags.php)。

第二处 PHP 标记出现在 `tags01_view.php` 中，是嵌入式的。比较特别的是，
这处标记使用的是 `<?=` 和 `?>`。这属于标记的一种简便写法，称之为短标记，
它的用途是直接输出里面的内容，等同于 `<?php echo '...' ?>` 。另一对短标记是 `<?  ?>`，
曾被作为 `<?php ?>` 的替代，但随着 PHP 语法的标准化，现在不建议使用它，在默认配置中，
也是被关闭使用的。

> `<?= ?>` 这对标记可谓一波三折。曾经由于短标记被默认关闭使用，它也随着被默认关闭了。
> 但其实当 PHP 文件用作视图使用的时候，这种嵌入式的简便写法是非常有效率且易读的，
> 于是在 PHP 5.4 中，它又被默认启用了，而且想关都关不掉。

最后一处标记包含的内容稍多，用于循环输出数据。当然你可以把 `<li>` 从 PHP 代码中分离出来，或者使用 `sprintf()` 来格式化数据，以使代码更美观。都可以，这里只是做一个简单的演示。

我们之前说过，当 PHP 用于视图文件中的时候，不应该包含太多的数据处理和计算。
但类似于调用函数这种一目了然，并没有进行复杂运算的代码，完全可以使用。


我们还在视图文件中使用了一个循环。类似于判断和循环这种基本的逻辑处理，在视图中其实是避免不了的，但是代码一定要简短清晰。
总之记住一点即可：**逻辑尽量与视图分离，代码可读性用强，最好一目了然**。